<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Password Manager</title>
    <link
      rel="icon"
      href="{{ url_for('static', filename='logo.png') }}"
      type="image/png"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google Fonts: Montserrat (for headings), Roboto (for everything else) -->
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat:700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='password.css') }}"
    />
  </head>
  <body>
    <!-- Top Bar -->
    <header class="topbar">
      <h1 class="site-title">PASSWORD MANAGER</h1>
      <form action="/landing" method="get" class="nav-brand">
        <button class="home-btn">Home</button>
      </form>
      <div class="toggle-row">
        <span class="toggle-label">Dark</span>
        <label class="toggle-switch">
          <input type="checkbox" id="theme-toggle" />
          <span class="slider"></span>
        </label>
        <span class="toggle-label">Light</span>
      </div>
      <!-- ignore account circle for now -->
    </header>

    <main>
      <h2 class="main-heading">STORE YOUR LOGINS</h2>
      <div class="layout-row">
        <!-- Left Form -->
        <form
          class="login-form"
          aria-label="Add Login"
          action="/addpassword"
          method="post"
        >
          <label for="website">Website</label>
          <input
            type="text"
            id="website"
            name="website"
            placeholder="Enter website"
            required
            autofocus
          />

          <label for="loginid">login id</label>
          <input
            type="text"
            id="loginid"
            name="loginid"
            placeholder="Enter login id"
            required
            autofocus
          />

          <label for="password">password</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Enter password"
            required
            autofocus
          />

          <button class="store-btn" type="submit">STORE PASSWORD</button>
        </form>

        <!-- Right Table -->
        <section class="login-table-section" aria-label="Saved Logins">
          <table class="login-table">
            <thead>
              <tr>
                <th>WEBSITE</th>
                <th>LOGIN ID</th>
                <th>PASSWORD</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for password in passwords %}
              <tr>
                <td>{{ password[1] }}</td>
                <td>${{password[2]}}</td>
                <td>{{ password[3] }}</td>
                <td>
                  <form action="/delpasrow" method="post">
                    <input
                      type="hidden"
                      name="row_id"
                      value="{{ password[0] }}"
                    />
                    <button type="submit" class="delete">delete</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </section>
      </div>
    </main>

    <script>
      // Theme toggle logic (light â†” dark + gray/blue button)
      const toggle = document.getElementById("theme-toggle");
      const body = document.body;

      function applyTheme(dark) {
        if (dark) {
          body.classList.add("dark");
          toggle.checked = true;
          localStorage.setItem("theme", "dark");
        } else {
          body.classList.remove("dark");
          toggle.checked = false;
          localStorage.setItem("theme", "light");
        }
      }

      toggle.addEventListener("change", () => {
        applyTheme(toggle.checked);
      });

      // On load, apply stored theme
      window.onload = function () {
        const saved = localStorage.getItem("theme");
        applyTheme(saved === "dark");
      };
    </script>
  </body>
</html>

